# 商家端功能说明

## 📱 项目概述
本项目是一个点菜小程序系统，包含**用户端**和**商家端**两个独立模块。

## 🏪 商家端功能

### 1. 订单管理流程
商家端可以完整管理订单的整个生命周期：

```
待接单 → 已接单 → 制作中 → 已完成
   ↓
 已取消（可在待接单/已接单阶段取消）
```

#### 订单状态说明：
- **待接单 (pending)** - 用户刚下单，等待商家确认
- **已接单 (accepted)** - 商家已接受订单，准备制作
- **制作中 (preparing)** - 商家正在制作菜品
- **已完成 (completed)** - 订单制作完成
- **已取消 (cancelled)** - 订单被拒绝或取消

### 2. 核心功能

#### 2.1 订单列表
- 实时显示所有订单
- 按状态筛选订单（待接单、已接单、制作中、已完成、已取消）
- 显示订单基本信息：订单号、顾客名称、菜品数量、总金额

#### 2.2 订单操作
- **接单**：接受待处理的订单
- **开始制作**：已接单后，开始制作菜品
- **完成订单**：制作完成，订单结束
- **拒绝/取消**：取消订单

#### 2.3 订单详情查看 ⭐
点击"查看详情"按钮可查看：
- 订单完整信息
- 每个菜品的详细信息
- **制作说明**：展开可查看每道菜的详细制作步骤、食材、调料等
- 顾客备注

#### 2.4 菜品管理
- **添加新菜品**：录入菜品名称、价格、描述、制作说明
- **查看菜品列表**：浏览所有菜品
- **编辑菜品**：修改菜品信息和制作说明
- **上架/下架**：控制菜品是否对用户可见

### 3. 实时通知
- WebSocket实时接收新订单通知
- 自动刷新订单列表
- 连接状态显示（右下角）

### 4. 统计数据
- 总订单数
- 待处理订单数
- 总收入（仅统计已完成订单）

## 👤 用户端功能
用户端提供点餐功能：
- 浏览菜品列表
- 添加菜品到购物车
- 提交订单
- 查看订单历史

## 🚀 使用步骤

### 启动项目
```powershell
# 激活虚拟环境并启动
.\aenv\Scripts\Activate.ps1
python .\Cook_applet.py
```

### 访问地址
- 用户端：http://localhost:8000/demo.html
- 商家端：http://localhost:8000/merchant.html
- API文档：http://localhost:8000/docs

## 📋 商家端操作流程示例

### 接收并处理订单：
1. 用户下单后，商家端自动收到新订单通知
2. 在"待接单"列表中查看订单详情
3. 点击"✅ 接单"确认接单
4. 点击"📋 查看详情"查看菜品制作说明
5. 点击"👨‍🍳 开始制作"开始制作
6. 按照制作说明完成菜品制作
7. 点击"✔️ 完成"标记订单完成

### 管理菜品：
1. 点击"➕ 添加新菜品"
2. 填写菜品信息（重点填写制作说明）
3. 在"📋 查看菜品列表"中管理现有菜品
4. 点击"✏️ 编辑"修改菜品信息

## 💡 制作说明功能
制作说明是本系统的核心功能之一，帮助商家标准化制作流程：

### 制作说明格式建议：
```
食材：
- 食材1
- 食材2

调料：
- 调料1
- 调料2

步骤：
1. 第一步操作
2. 第二步操作
3. 第三步操作
```

### 查看制作说明：
- 在订单详情页面，每个菜品下方都有"👨‍🍳 制作说明"
- 点击展开即可查看完整的制作步骤

## 🔧 技术栈
- **后端**：FastAPI + SQLAlchemy
- **前端**：原生HTML/CSS/JavaScript
- **实时通信**：WebSocket
- **数据库**：SQLite

## 📝 注意事项
1. 订单状态流程是线性的，不能跳过步骤
2. 已完成的订单不能取消
3. WebSocket连接断开会自动重连（5秒后）
4. 建议定期备份数据库文件 `cook_applet.db`

## 🎯 后续优化建议
- [ ] 添加订单打印功能
- [ ] 支持多商家管理
- [ ] 增加销售数据统计图表
- [ ] 支持语音播报新订单
- [ ] 添加菜品图片上传功能
