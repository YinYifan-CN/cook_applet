# ğŸ½ï¸ ç¾é£Ÿç‚¹é¤ç³»ç»Ÿ

åŸºäºPython FastAPIçš„å¾®ä¿¡å°ç¨‹åºç‚¹é¤ç³»ç»Ÿï¼Œæ”¯æŒç”¨æˆ·ç‚¹é¤ã€å•†å®¶ç®¡ç†ã€å®æ—¶è®¢å•é€šçŸ¥ç­‰åŠŸèƒ½ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·ç«¯
- ğŸ“± å¾®ä¿¡å°ç¨‹åºé£æ ¼ç•Œé¢
- ğŸœ èœå“æµè§ˆä¸åˆ†ç±»ç­›é€‰
- ğŸ›’ è´­ç‰©è½¦ç®¡ç†
- ğŸ“– èœå“è¯¦æƒ…æŸ¥çœ‹ï¼ˆå«åˆ¶ä½œè¯´æ˜ï¼‰
- ğŸ’³ åœ¨çº¿ä¸‹å•ä¸æ”¯ä»˜
- ğŸ“ è®¢å•å¤‡æ³¨

### å•†å®¶ç«¯
- ğŸª å®æ—¶è®¢å•ç®¡ç†
- ğŸ“Š è®¢å•ç»Ÿè®¡ä¸æ•°æ®åˆ†æ
- ğŸ”” WebSocketå®æ—¶è®¢å•é€šçŸ¥
- ğŸ‘¨â€ğŸ³ è®¢å•çŠ¶æ€æµè½¬ï¼ˆå¾…ç¡®è®¤â†’å·²ç¡®è®¤â†’åˆ¶ä½œä¸­â†’å¾…å–é¤â†’å·²å®Œæˆï¼‰
- ğŸ’° æ”¶å…¥ç»Ÿè®¡

### ç³»ç»Ÿç‰¹æ€§
- ğŸ—„ï¸ SQLiteæ•°æ®åº“å­˜å‚¨
- ğŸ“„ PDFèœè°±è§£æ
- âš¡ å¼‚æ­¥APIè®¾è®¡
- ğŸ”Œ WebSocketå®æ—¶é€šä¿¡
- ğŸ¨ å“åº”å¼UIè®¾è®¡

## ğŸ“ é¡¹ç›®ç»“æ„

```
Cook_applet/
â”œâ”€â”€ Cook_applet.py          # ä¸»åº”ç”¨ç¨‹åºï¼ˆFastAPIï¼‰
â”œâ”€â”€ database.py             # æ•°æ®åº“æ¨¡å‹å®šä¹‰
â”œâ”€â”€ config.py               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ utils.py                # å·¥å…·å‡½æ•°
â”œâ”€â”€ pdf_parser.py           # PDFè§£ææ¨¡å—
â”œâ”€â”€ init_data.py            # åˆå§‹åŒ–ç¤ºä¾‹æ•°æ®
â”œâ”€â”€ requirements.txt        # Pythonä¾èµ–
â”œâ”€â”€ start.sh                # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ restart.sh              # é‡å¯è„šæœ¬
â”œâ”€â”€ demo.html               # ç”¨æˆ·ç«¯ç•Œé¢
â”œâ”€â”€ merchant.html           # å•†å®¶ç«¯ç•Œé¢
â”œâ”€â”€ cook_applet.db          # SQLiteæ•°æ®åº“ï¼ˆè¿è¡Œåç”Ÿæˆï¼‰
â””â”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.8+
- pip

### 2. å®‰è£…ä¾èµ–

```bash
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœæœ‰ï¼‰
source aenv/bin/activate

# å®‰è£…PythonåŒ…
pip install -r requirements.txt
```

### 3. åˆå§‹åŒ–æ•°æ®åº“

```bash
# åˆ›å»ºæ•°æ®åº“è¡¨
python database.py

# å¯¼å…¥ç¤ºä¾‹èœå“æ•°æ®ï¼ˆ6é“èœï¼‰
python init_data.py
```

### 4. å¯åŠ¨æœåŠ¡å™¨

```bash
# æ–¹å¼1ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬
./start.sh

# æ–¹å¼2ï¼šä½¿ç”¨é‡å¯è„šæœ¬ï¼ˆä¼šå…ˆæ¸…ç†8000ç«¯å£ï¼‰
./restart.sh

# æ–¹å¼3ï¼šç›´æ¥è¿è¡Œ
python Cook_applet.py
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:8000` å¯åŠ¨

### 5. è®¿é—®ç³»ç»Ÿ

- **ç”¨æˆ·ç«¯**: http://localhost:8000/demo.html
- **å•†å®¶ç«¯**: http://localhost:8000/merchant.html
- **APIæ–‡æ¡£**: http://localhost:8000/docs

## ğŸ“¦ ä¾èµ–è¯´æ˜

```
fastapi==0.104.1         # Webæ¡†æ¶
uvicorn==0.24.0          # ASGIæœåŠ¡å™¨
sqlalchemy==2.0.23       # ORMæ¡†æ¶
PyPDF2==3.0.1            # PDFè§£æ
websockets==12.0         # WebSocketæ”¯æŒ
```

## ğŸ”§ é…ç½®è¯´æ˜

ç¼–è¾‘ `config.py` ä¿®æ”¹é…ç½®ï¼š

```python
DATABASE_URL = "sqlite:///cook_applet.db"  # æ•°æ®åº“è·¯å¾„
HOST = "0.0.0.0"                           # æœåŠ¡å™¨åœ°å€
PORT = 8000                                # æœåŠ¡å™¨ç«¯å£
```

## ğŸ“‹ APIæ¥å£

### ç”¨æˆ·ç«¯æ¥å£

- `GET /api/user/dishes` - è·å–èœå“åˆ—è¡¨
- `GET /api/user/categories` - è·å–èœå“åˆ†ç±»
- `POST /api/user/orders` - åˆ›å»ºè®¢å•
- `POST /api/user/payment` - æ”¯ä»˜è®¢å•

### å•†å®¶ç«¯æ¥å£

- `GET /api/merchant/orders` - è·å–æ‰€æœ‰è®¢å•
- `PUT /api/merchant/orders/{order_id}` - æ›´æ–°è®¢å•çŠ¶æ€
- `GET /api/merchant/dishes` - è·å–èœå“ç®¡ç†åˆ—è¡¨
- `WS /ws/merchant` - WebSocketå®æ—¶é€šçŸ¥

## ğŸ—ƒï¸ æ•°æ®åº“æ¨¡å‹

### DishModelï¼ˆèœå“è¡¨ï¼‰
- id: ä¸»é”®
- name: èœå“åç§°
- category: åˆ†ç±»
- price: ä»·æ ¼
- description: æè¿°
- cooking_instructions: åˆ¶ä½œè¯´æ˜
- image_url: å›¾ç‰‡URL
- is_available: æ˜¯å¦å¯å”®

### OrderModelï¼ˆè®¢å•è¡¨ï¼‰
- id: è®¢å•å·ï¼ˆæ ¼å¼ï¼šORD20240101120000ï¼‰
- user_id: ç”¨æˆ·ID
- user_name: ç”¨æˆ·å
- items: è®¢å•é¡¹ï¼ˆJSONï¼‰
- total_amount: æ€»é‡‘é¢
- status: çŠ¶æ€ï¼ˆpending/confirmed/preparing/ready/completedï¼‰
- note: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´
- updated_at: æ›´æ–°æ—¶é—´

### UserModelï¼ˆç”¨æˆ·è¡¨ï¼‰
- id: ç”¨æˆ·ID
- openid: å¾®ä¿¡OpenID
- nickname: æ˜µç§°
- phone: æ‰‹æœºå·
- created_at: æ³¨å†Œæ—¶é—´

## ğŸ¯ ç¤ºä¾‹èœå“

ç³»ç»Ÿé¢„ç½®6é“ç»å…¸èœå“ï¼š

1. **å®«ä¿é¸¡ä¸** - å·èœç»å…¸ï¼Œé¸¡è‚‰ä¸èŠ±ç”Ÿçš„å®Œç¾æ­é…
2. **é±¼é¦™è‚‰ä¸** - é…¸ç”œå¯å£ï¼Œè‰²é¦™å‘³ä¿±å…¨
3. **éº»å©†è±†è…** - éº»è¾£é²œé¦™ï¼Œä¸‹é¥­ç¥å™¨
4. **çº¢çƒ§è‚‰** - è‚¥è€Œä¸è…»ï¼Œå…¥å£å³åŒ–
5. **æ¸…è’¸é²ˆé±¼** - é²œå«©å¯å£ï¼ŒåŸæ±åŸå‘³
6. **ç³–é†‹æ’éª¨** - é…¸ç”œé€‚ä¸­ï¼Œå¤–é…¥é‡Œå«©

æ¯é“èœéƒ½åŒ…å«è¯¦ç»†çš„åˆ¶ä½œè¯´æ˜ï¼ˆé£Ÿæã€è°ƒæ–™ã€æ­¥éª¤ï¼‰ã€‚

## ğŸ”„ è®¢å•æµç¨‹

```
ç”¨æˆ·ä¸‹å• â†’ å¾…ç¡®è®¤(pending) â†’ å·²ç¡®è®¤(confirmed) 
         â†’ åˆ¶ä½œä¸­(preparing) â†’ å¾…å–é¤(ready) 
         â†’ å·²å®Œæˆ(completed)
```

## ğŸ› ï¸ å¼€å‘è¯´æ˜

### æ·»åŠ æ–°èœå“

```python
from database import SessionLocal, DishModel

session = SessionLocal()
new_dish = DishModel(
    name="æ–°èœå",
    category="åˆ†ç±»",
    price=29.99,
    description="èœå“æè¿°",
    cooking_instructions="åˆ¶ä½œè¯´æ˜",
    is_available=True
)
session.add(new_dish)
session.commit()
```

### PDFèœè°±è§£æ

å°†èœè°±PDFæ”¾å…¥é¡¹ç›®ç›®å½•ï¼Œä½¿ç”¨ï¼š

```python
from pdf_parser import parse_pdf_dishes

dishes = parse_pdf_dishes("èœè°±.pdf")
```

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹å ç”¨8000ç«¯å£çš„è¿›ç¨‹
lsof -ti:8000

# æ€æ­»è¿›ç¨‹
lsof -ti:8000 | xargs kill -9

# æˆ–ä½¿ç”¨restart.shè‡ªåŠ¨å¤„ç†
./restart.sh
```

### 2. æ•°æ®åº“æœªåˆå§‹åŒ–

```bash
python database.py
python init_data.py
```

### 3. WebSocketè¿æ¥å¤±è´¥

ç¡®ä¿åç«¯æœåŠ¡æ­£å¸¸è¿è¡Œï¼Œæ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰CORSé”™è¯¯ã€‚

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-01)
- âœ… å®Œæˆç”¨æˆ·ç«¯ç‚¹é¤åŠŸèƒ½
- âœ… å®Œæˆå•†å®¶ç«¯è®¢å•ç®¡ç†
- âœ… å®ç°WebSocketå®æ—¶é€šçŸ¥
- âœ… æ·»åŠ èœå“è¯¦æƒ…å±•ç¤º
- âœ… æ”¯æŒè®¢å•çŠ¶æ€æµè½¬
- âœ… é›†æˆPDFèœè°±è§£æ

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¥ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤Issueæˆ–è”ç³»å¼€å‘è€…ã€‚

---

**äº«å—çƒ¹é¥ªï¼Œäº«å—ç”Ÿæ´»ï¼ğŸ³**