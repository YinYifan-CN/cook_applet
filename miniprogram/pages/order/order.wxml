<!--pages/order/order.wxml-->
<view class="container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <view 
      class="filter-item {{statusFilter === 'all' ? 'active' : ''}}" 
      bindtap="filterOrders" 
      data-status="all"
    >å…¨éƒ¨</view>
    <view 
      class="filter-item {{statusFilter === 'pending' ? 'active' : ''}}" 
      bindtap="filterOrders" 
      data-status="pending"
    >å¾…ç¡®è®¤</view>
    <view 
      class="filter-item {{statusFilter === 'preparing' ? 'active' : ''}}" 
      bindtap="filterOrders" 
      data-status="preparing"
    >åˆ¶ä½œä¸­</view>
    <view 
      class="filter-item {{statusFilter === 'completed' ? 'active' : ''}}" 
      bindtap="filterOrders" 
      data-status="completed"
    >å·²å®Œæˆ</view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list">
    <view 
      class="order-card" 
      wx:for="{{filteredOrders}}" 
      wx:key="id"
      bindtap="viewOrderDetail"
      data-order="{{item}}"
    >
      <view class="order-header">
        <view class="order-id">è®¢å•å·ï¼š{{item.id}}</view>
        <view class="order-status status-{{item.status}}">{{statusMap[item.status]}}</view>
      </view>
      
      <!-- è¿›åº¦æ¡ -->
      <view class="order-progress" wx:if="{{item.status !== 'cancelled'}}">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{item.progressPercent}}%"></view>
        </view>
        <view class="progress-text">{{item.progressText}} ({{item.progressStep}}/{{item.progressTotal}})</view>
      </view>
      
      <view class="order-items">
        <view class="order-item" wx:for="{{item.items}}" wx:key="dish_id" wx:for-item="dish">
          <text>{{dish.dish_name}} x{{dish.quantity}}</text>
        </view>
      </view>

      <view class="order-footer">
        <view class="order-time">{{formatTime(item.created_at)}}</view>
        <view class="order-total">Â¥{{item.total_amount}}</view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredOrders.length === 0}}">
    <view class="empty-state-icon">ğŸ“‹</view>
    <view class="empty-state-text">æš‚æ— è®¢å•</view>
  </view>
</view>
